<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>365å¤©ç›²ç›’å­˜éŒ¢æŒ‘æˆ°</title>
    <style>
        :root {
            --primary: #ff7675;
            --secondary: #fab1a0;
            --bg: #fff5f5;
            --box-bg: #ffeaa7;
        }
        body { font-family: 'PingFang TC', sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(255,118,117,0.15); width: 100%; max-width: 600px; text-align: center; }
        h1 { color: var(--primary); margin: 0 0 10px 0; font-size: 24px; }
        
        .progress-section { margin: 20px 0; }
        .progress-bar-bg { width: 100%; height: 15px; background: #eee; border-radius: 10px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: linear-gradient(90deg, #fab1a0, #ff7675); width: 0%; transition: 0.8s; }
        
        .stats { display: flex; justify-content: space-around; margin-bottom: 20px; }
        .stat-item b { font-size: 20px; color: var(--primary); display: block; }
        .stat-item span { font-size: 12px; color: #b2bec3; }

        .random-btn { 
            background: var(--primary); color: white; border: none; padding: 12px 25px; 
            border-radius: 50px; font-size: 16px; font-weight: bold; cursor: pointer;
            margin-bottom: 25px; transition: 0.3s; box-shadow: 0 4px 15px rgba(255,118,117,0.4);
        }
        .random-btn:active { transform: scale(0.9); }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(45px, 1fr)); gap: 8px; }
        .box { 
            aspect-ratio: 1; background: var(--box-bg); border-radius: 10px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 14px; cursor: pointer; transition: 0.3s; color: transparent;
            position: relative; border: 2px solid transparent;
        }
        /* ç›²ç›’æœªé–‹å•Ÿçš„åœ–ç¤º */
        .box::before { content: "ğŸ"; color: #e67e22; font-size: 18px; position: absolute; }
        
        /* å·²é–‹å•Ÿçš„ç‹€æ…‹ */
        .box.done { 
            background: var(--primary); color: white; transform: rotate(360deg); 
            box-shadow: 0 4px 8px rgba(255,118,117,0.3); font-weight: bold;
        }
        .box.done::before { content: ""; }

        /* è¢«éš¨æ©ŸæŠ½ä¸­çš„é–ƒçˆæ•ˆæœ */
        .box.highlight { border: 3px solid #d63031; transform: scale(1.2); z-index: 10; animation: blink 0.5s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div class="card">
        <h1>ğŸ“ 365å¤©ç›²ç›’å­˜éŒ¢</h1>
        <p style="color: #636e72; font-size: 14px;">é»æ“ŠğŸé–‹å•Ÿé©šå–œé‡‘é¡</p>
        
        <div class="progress-section">
            <div class="progress-bar-bg"><div class="progress-bar-fill" id="pb"></div></div>
        </div>

        <div class="stats">
            <div class="stat-item"><b id="total">$0</b><span>ç´¯ç©é‡‘é¡</span></div>
            <div class="stat-item"><b id="percent">0%</b><span>å®Œæˆé€²åº¦</span></div>
            <div class="stat-item"><b id="count">0/365</b><span>å­˜éŒ¢å¤©æ•¸</span></div>
        </div>

        <button class="random-btn" onclick="drawBox()">ğŸ² æŠ½ä»Šå¤©çš„ç›²ç›’</button>

        <div class="grid" id="grid"></div>
    </div>

    <script>
        const grid = document.getElementById('grid');
        let saved = JSON.parse(localStorage.getItem('365_blind_data')) || [];
        
        function update() {
            const sum = saved.reduce((a, b) => a + b, 0);
            document.getElementById('total').innerText = '$' + sum.toLocaleString();
            const p = ((saved.length / 365) * 100).toFixed(1);
            document.getElementById('percent').innerText = p + '%';
            document.getElementById('pb').style.width = p + '%';
            document.getElementById('count').innerText = `${saved.length}/365`;
        }

        // åˆå§‹åŒ–æ ¼å­
        for (let i = 1; i <= 365; i++) {
            const div = document.createElement('div');
            div.className = 'box' + (saved.includes(i) ? ' done' : '');
            div.id = 'box-' + i;
            div.innerText = i;
            div.onclick = () => toggleBox(i);
            grid.appendChild(div);
        }

        function toggleBox(i) {
            const el = document.getElementById('box-' + i);
            if (saved.includes(i)) {
                if(confirm(`ç¢ºå®šè¦å–æ¶ˆç¬¬ ${i} å¤©çš„ç´€éŒ„å—ï¼Ÿ`)) {
                    saved = saved.filter(n => n !== i);
                    el.classList.remove('done');
                }
            } else {
                saved.push(i);
                el.classList.add('done');
                el.classList.remove('highlight');
            }
            localStorage.setItem('365_blind_data', JSON.stringify(saved));
            update();
        }

        function drawBox() {
            // æ‰¾å‡ºé‚„æ²’å­˜çš„æ•¸å­—
            const remaining = [];
            for(let i=1; i<=365; i++) {
                if(!saved.includes(i)) remaining.push(i);
            }
            
            if(remaining.length === 0) {
                alert("æ­å–œï¼ä½ å·²ç¶“å®Œæˆ 365 å¤©æŒ‘æˆ°äº†ï¼ğŸ‰");
                return;
            }

            // æ¸…é™¤ä¹‹å‰çš„äº®é»
            const oldHighlight = document.querySelector('.highlight');
            if(oldHighlight) oldHighlight.classList.remove('highlight');

            // éš¨æ©ŸæŠ½ä¸€å€‹
            const randomIndex = Math.floor(Math.random() * remaining.length);
            const chosen = remaining[randomIndex];
            const chosenEl = document.getElementById('box-' + chosen);
            
            // æ²å‹•åˆ°é‚£å€‹ä½ç½®ä¸¦é–ƒçˆ
            chosenEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
            chosenEl.classList.add('highlight');
            
            setTimeout(() => {
                alert(`ğŸ² ä»Šæ—¥æŠ½åˆ°çš„ç›²ç›’é‡‘é¡æ˜¯ï¼š$${chosen} å…ƒï¼\nå¿«æŠŠå®ƒå­˜èµ·ä¾†ä¸¦é»æ“Šæ ¼å§ï¼`);
            }, 500);
        }

        update();
    </script>
</body>
</html>
